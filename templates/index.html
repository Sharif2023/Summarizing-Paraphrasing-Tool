<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Free Summarizer & Paraphraser</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Arial, sans-serif; max-width:900px; margin:30px auto; padding:0 16px; color:#111; }
    textarea { width:100%; min-height:160px; padding:10px; font-size:14px; }
    .row { display:flex; gap:12px; align-items:center; margin:10px 0; flex-wrap:wrap; }
    button { padding:10px 14px; font-size:14px; cursor:pointer; }
    .box { border:1px solid #ddd; padding:12px; border-radius:6px; background:#fafafa; }
    label { font-weight:600; margin-right:8px; }
  </style>
</head>
<body>
  <h1>Free Summarizer & Paraphraser</h1>

  <div class="box">
    <label for="inputText">Paste your text here</label>
    <textarea id="inputText" placeholder="Paste or type the paragraph(s) you want summarized/paraphrased..."></textarea>

    <div class="row">
      <div>
        <label>Summary ratio:</label>
        <input id="ratio" type="range" min="0.1" max="0.9" value="0.3" step="0.05">
        <span id="ratioVal">0.30</span>
      </div>

      <div>
        <label>Min sentences:</label>
        <input id="minSent" type="number" value="1" min="1" style="width:70px">
      </div>

      <div>
        <label>Paraphrase strength:</label>
        <input id="strength" type="range" min="0" max="1" step="0.05" value="0.3">
        <span id="strengthVal">0.30</span>
      </div>
    </div>

    <div class="row">
      <button id="btnSumm">Summarize</button>
      <button id="btnPara">Paraphrase</button>
      <button id="btnBoth">Summarize â†’ Paraphrase</button>
      <button id="btnClear">Clear</button>
    </div>

    <h3>Output</h3>
    <div id="output" class="box" style="min-height:120px"></div>
  </div>

<script>
  const ratio = document.getElementById('ratio');
  const ratioVal = document.getElementById('ratioVal');
  ratioVal.textContent = parseFloat(ratio.value).toFixed(2);
  ratio.addEventListener('input', ()=> ratioVal.textContent = parseFloat(ratio.value).toFixed(2));

  const strength = document.getElementById('strength');
  const strengthVal = document.getElementById('strengthVal');
  strengthVal.textContent = parseFloat(strength.value).toFixed(2);
  strength.addEventListener('input', ()=> strengthVal.textContent = parseFloat(strength.value).toFixed(2));

  document.getElementById('btnSumm').addEventListener('click', async () => {
    const txt = document.getElementById('inputText').value;
    const res = await fetch('/summarize', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ text: txt, ratio: parseFloat(ratio.value), min_sentences: parseInt(document.getElementById('minSent').value || 1) })
    });
    const data = await res.json();
    if (!data.ok) {
      showOutput('Error: ' + (data.error || 'unknown'));
    } else {
      showOutput(data.summary);
    }
  });

  document.getElementById('btnPara').addEventListener('click', async () => {
    const txt = document.getElementById('inputText').value;
    const res = await fetch('/paraphrase', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ text: txt, strength: parseFloat(strength.value) })
    });
    const data = await res.json();
    if (!data.ok) {
      showOutput('Error: ' + (data.error || 'unknown'));
    } else {
      showOutput(data.paraphrase);
    }
  });

  document.getElementById('btnBoth').addEventListener('click', async () => {
    const txt = document.getElementById('inputText').value;
    // summarize first
    const sres = await fetch('/summarize', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ text: txt, ratio: parseFloat(ratio.value), min_sentences: parseInt(document.getElementById('minSent').value || 1) })
    });
    const sdata = await sres.json();
    if (!sdata.ok) { showOutput('Error summarizing: ' + (sdata.error || 'unknown')); return; }
    const summary = sdata.summary;
    // paraphrase summary
    const pres = await fetch('/paraphrase', {
      method: 'POST', headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ text: summary, strength: parseFloat(strength.value) })
    });
    const pdata = await pres.json();
    if (!pdata.ok) { showOutput('Error paraphrasing: ' + (pdata.error || 'unknown')); return; }
    showOutput(pdata.paraphrase);
  });

  document.getElementById('btnClear').addEventListener('click', ()=> {
    document.getElementById('inputText').value='';
    showOutput('');
  });

  function showOutput(txt){
    const out = document.getElementById('output');
    out.textContent = txt;
  }
</script>
</body>
</html>
